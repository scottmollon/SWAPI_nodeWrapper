var SW_API=function(){var a=require("request"),b=require("q"),c="http://swapi.co/api/",d=null,e=function(b,c,d){c=c||{};var e={url:b,method:"GET",qs:c};a(e,d)},f=function(){var a=b.defer(),f=function(b,c,e){b?a.reject(b):200===c.statusCode?(d=JSON.parse(e),a.resolve(!0)):a.reject(e.message)};return e(c,{},f),a.promise},g=function(){var a=b.defer();return null===d?f().then(function(){a.resolve(!0)},function(b){a.reject(b)}):a.resolve(!0),a.promise};return{getResourceTypes:function(){var a=b.defer();return g().then(function(){a.resolve(Object.keys(d))}),a.promise},getAllResourcesByType:function(a,c){var f=b.defer();c=c||1;var h=function(a,b,d){a?f.reject(a):200===b.statusCode?(responseBody=JSON.parse(d),responseBody.totalPages=Math.ceil(responseBody.count/10),responseBody.currentPage=c,f.resolve(responseBody)):f.reject(JSON.parse(d))};return g().then(function(){e(d[a],{page:c},h)}),f.promise},getResourceById:function(a,c){var f=b.defer(),h=function(a,b,c){a?f.reject(a):200===b.statusCode?f.resolve(JSON.parse(c)):f.reject(c.message)};return g().then(function(){e(d[a]+c,{},h)}),f.promise},getResourcesBySearch:function(a,c,f){var h=b.defer();f=f||1;var i=function(a,b,c){a?h.reject(a):200===b.statusCode?(responseBody=JSON.parse(c),responseBody.totalPages=Math.ceil(responseBody.count/10),responseBody.currentPage=f,h.resolve(responseBody)):h.reject(JSON.parse(c))};return g().then(function(){e(d[a],{search:c,page:f},i)}),h.promise}}};module.exports=new SW_API;